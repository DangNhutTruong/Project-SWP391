<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test API</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h2 { color: #333; }
    button { margin: 10px 0; padding: 8px 12px; cursor: pointer; }
    pre { background: #f4f4f4; padding: 15px; border-radius: 5px; overflow-x: auto; }
  </style>
</head>
<body>
  <h1>API Testing Tool</h1>
  
  <div>
    <h2>Kiểm tra kết nối</h2>
    <button onclick="checkHealth()">Check Health</button>
    <pre id="healthResult">Kết quả sẽ hiển thị ở đây...</pre>
  </div>
  
  <div>
    <h2>Lấy danh sách người dùng</h2>
    <button onclick="getUsers()">Get Users</button>
    <pre id="usersResult">Kết quả sẽ hiển thị ở đây...</pre>
  </div>
  
  <div>
    <h2>Đăng ký người dùng mới (Test)</h2>
    <form id="registerForm">
      <div>
        <label for="name">Name:</label>
        <input type="text" id="name" value="Test User" required>
      </div>
      <div>
        <label for="email">Email:</label>
        <input type="email" id="email" value="testuser123@example.com" required>
      </div>
      <div>
        <label for="password">Password:</label>
        <input type="password" id="password" value="123456" required>
      </div>
      <div>
        <label for="age">Age:</label>
        <input type="number" id="age" value="25">
      </div>
      <div>
        <label for="gender">Gender:</label>
        <select id="gender">
          <option value="Male">Male</option>
          <option value="Female">Female</option>
          <option value="Other">Other</option>
        </select>
      </div>
      <div>
        <label for="phone">Phone:</label>
        <input type="text" id="phone" value="0912345678">
      </div>
      <button type="button" onclick="registerUser()">Register</button>
    </form>
    <pre id="registerResult">Kết quả sẽ hiển thị ở đây...</pre>
  </div>

  <script>
    const API_BASE_URL = 'http://localhost:5000';
    
    async function checkHealth() {
      const healthResult = document.getElementById('healthResult');
      healthResult.textContent = 'Đang kiểm tra...';
      
      try {
        const response = await fetch(`${API_BASE_URL}/health`);
        const data = await response.json();
        healthResult.textContent = JSON.stringify(data, null, 2);
      } catch (error) {
        healthResult.textContent = `Error: ${error.message}`;
      }
    }
    
    async function getUsers() {
      const usersResult = document.getElementById('usersResult');
      usersResult.textContent = 'Đang tải dữ liệu...';
      
      try {
        const response = await fetch(`${API_BASE_URL}/api/users/debug/all`);
        const data = await response.json();
        usersResult.textContent = JSON.stringify(data, null, 2);
      } catch (error) {
        usersResult.textContent = `Error: ${error.message}`;
      }
    }
    
    async function registerUser() {
      const registerResult = document.getElementById('registerResult');
      registerResult.textContent = 'Đang đăng ký...';
      
      const userData = {
        name: document.getElementById('name').value,
        email: document.getElementById('email').value,
        password: document.getElementById('password').value,
        age: document.getElementById('age').value,
        gender: document.getElementById('gender').value,
        phone: document.getElementById('phone').value
      };
      
      try {
        const response = await fetch(`${API_BASE_URL}/api/auth/register`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(userData)
        });
        
        const data = await response.json();
        registerResult.textContent = JSON.stringify(data, null, 2);
        
        // Nếu đăng ký thành công, tải lại danh sách người dùng
        if (data.success) {
          setTimeout(getUsers, 1000);
        }
      } catch (error) {
        registerResult.textContent = `Error: ${error.message}`;
      }
    }
  </script>
</body>
</html>
